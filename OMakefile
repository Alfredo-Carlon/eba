USE_OCAMLFIND = true
BYTE_ENABLED = true
NATIVE_ENABLED = false

FILES[] =
    error
    utils
    pP
    uniq
    type
    axioms
    env
    funAbs
    fileAbs
    structs
    infer
    pathTree
    fileChecker
    checkUninitFile
    fiChecker
    checkFiNoret
    flow1Checker
    checkUninitFlow1
    flow2Checker
    checkDLockFlow2
    checkBhOnIrqFlow2

OCAMLPACKS[] += batteries cil ocamlgraph smart_print cmdliner dolog
OCAMLFLAGS += -thread

OCamlLibrary(libeba, $(FILES))

OCAML_LIBS = libeba
OCamlProgram(eba, eba)

.DEFAULT: eba

# Cleanup
.PHONY: clean
clean:
  rm -f \
     $(filter-proper-targets $(glob $(addsuffix .*, $(FILES)))) \
     eba.cma eba.cmxa eba.a
